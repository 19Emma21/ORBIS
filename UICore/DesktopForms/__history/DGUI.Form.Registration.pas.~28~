unit DGUI.Form.Registration;

interface

uses
  System.SysUtils,
  System.Types,
  System.UITypes,
  System.Classes,
  System.Variants,
  App.Globals,
  UI.Types,
  FMX.Types,
  FMX.Controls,
  FMX.Forms,
  FMX.Graphics,
  FMX.Dialogs,
  FMX.Layouts,
  FMX.Objects,
  FMX.Edit,
  FMX.Controls.Presentation,
  FMX.StdCtrls,
  FMX.Ani,
  DGUI.Form.Resources;

type
  TRegistrationForm = class(TForm)
    OrbisLogoPath1: TPath;
    OrbisLogoPath2: TPath;
    OrbisLogoPath3: TPath;
    LogoLayout: TLayout;
    HeadLabel: TLabel;
    EnterPassLayout: TLayout;
    RepeatPassLabel: TLabel;
    EnterPassLabel: TLabel;
    EnterPassEdit: TEdit;
    RepeatPassEdit: TEdit;
    GoRegRectangle: TRectangle;
    LogInRectangle: TRectangle;
    logInLabel: TLabel;
    EnterPassErrorLabel: TLabel;
    RepeatPassErrorLabel: TLabel;
    RegColorAnimation: TColorAnimation;
    GoRegLabel: TLabel;
    TextColorAnimation: TColorAnimation;
    procedure GoRegRectangleClick(Sender: TObject);
    procedure EditChange(Sender: TObject);
    procedure LogInRectangleClick(Sender: TObject);
    procedure RegColorAnimationFinish(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure TextColorAnimationFinish(Sender: TObject);
  private
    GoAnimation: Boolean;
    function CheckPasswords: boolean;
  public
    { Public declarations }
  end;

var
  RegistrationForm: TRegistrationForm;

implementation

{$R *.fmx}

function TRegistrationForm.CheckPasswords: boolean;
begin
  Result := (EnterPassEdit.Text.Length > 6)and(EnterPassEdit.Text = RepeatPassEdit.Text)
end;

procedure TRegistrationForm.EditChange(Sender: TObject);
begin
  EnterPassErrorLabel.Visible := (not EnterPassEdit.Text.IsEmpty) and
    (EnterPassEdit.Text.Length < 6);
  RepeatPassErrorLabel.Visible := (not RepeatPassEdit.Text.IsEmpty) and
    (EnterPassEdit.Text <> RepeatPassEdit.Text);

  RegColorAnimation.Inverse := EnterPassEdit.Text.IsEmpty or RepeatPassEdit.Text.IsEmpty;
  TextColorAnimation.Inverse := RegColorAnimation.Inverse;
  RegColorAnimation.Enabled := RegColorAnimation.Inverse <> GoAnimation;
  TextColorAnimation.Enabled := RegColorAnimation.Enabled;
  GoAnimation := EnterPassEdit.Text.IsEmpty or RepeatPassEdit.Text.IsEmpty;
end;

procedure TRegistrationForm.FormCreate(Sender: TObject);
begin
  GoAnimation := True;
end;

procedure TRegistrationForm.GoRegRectangleClick(Sender: TObject);
begin
  if CheckPasswords then
    AppCore.ShowForm(ord(fVerification),[]);
end;

procedure TRegistrationForm.LogInRectangleClick(Sender: TObject);
begin
  // Нажатие кнопки входа
  AppCore.ShowForm(ord(fLogin),[]);
end;

procedure TRegistrationForm.RegColorAnimationFinish(Sender: TObject);
begin
  if RegColorAnimation.Inverse then
    GoRegRectangle.Fill.Color := RegColorAnimation.StartValue
  else
    GoRegRectangle.Fill.Color := RegColorAnimation.StopValue;
  RegColorAnimation.Enabled := False;
end;

procedure TRegistrationForm.TextColorAnimationFinish(Sender: TObject);
begin
  if TextColorAnimation.Inverse then
    GoRegLabel.TextSettings.FontColor := TextColorAnimation.StartValue
  else
    GoRegLabel.TextSettings.FontColor := TextColorAnimation.StopValue;
  TextColorAnimation.Enabled := False;
end;

end.
